<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tesla Dashboard</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      font-family: sans-serif;
      background-color: black;
      overflow: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      top: -1000px;
      left: -1000px;
      width: 5000px;
      height: 5000px;
      background: black;
      z-index: -1;
    }

    #map {
      height: 100%;
      width: 100%;
    }

    #destination-input {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1001;
      background: #222;
      padding: 8px;
      border-radius: 6px;
      width: 320px;
      box-shadow: 0 0 10px #000;
    }

    #destination-input input {
      width: 100%;
      padding: 6px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
      background: #111;
      color: white;
    }

    #searchResults {
      max-height: 250px;
      overflow-y: auto;
      background: #111;
      margin-top: 4px;
      border-radius: 6px;
      color: white;
      box-shadow: 0 0 10px #000;
      display: none;
    }

    .search-result {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }

    .search-result:hover {
      background: #333;
    }

    .search-result button {
      background: #00FF00;
      border: none;
      color: #000;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
    }

    #etaDisplay, #stopButton {
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: #222;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      z-index: 1001;
      font-family: monospace;
      display: none;
    }

    #stopButton {
      bottom: 140px;
      cursor: pointer;
      background: #ff4444;
    }

    #bottom-buttons {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      z-index: 1001;
    }

    #bottom-buttons button {
      color: white;
      background: transparent;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <div id="destination-input">
    <input type="text" id="destination" placeholder="Search destination..." autocomplete="off" />
    <div id="searchResults"></div>
  </div>

  <div id="etaDisplay">ETA:</div>
  <div id="stopButton">Stop</div>

  <div id="bottom-buttons">
    <button onclick="recenterMap()">Recenter</button>
    <button>Music</button>
    <button>Navigation</button>
  </div>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDNIMK5n09eQactHuhsqzZomcj-0Gyv_NA&libraries=places"></script>
  <script>
    let map, directionsRenderer, directionsService, userMarker, userPosition, watchId;
    let routing = false;

    function initMap() {
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({ suppressMarkers: true });

      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: { lat: 0, lng: 0 },
        disableDefaultUI: true,
        styles: [ { elementType: "geometry", stylers: [ { color: "#000000" } ] }, { elementType: "labels.text.fill", stylers: [ { color: "#ffffff" } ] }, { elementType: "labels.text.stroke", stylers: [ { color: "#000000" } ] }, { featureType: "road", stylers: [ { color: "#444444" } ] } ]
      });

      directionsRenderer.setMap(map);

      if (navigator.geolocation) {
        watchId = navigator.geolocation.watchPosition(pos => {
          userPosition = { lat: pos.coords.latitude, lng: pos.coords.longitude };
          if (!userMarker) {
            userMarker = new google.maps.Marker({
              position: userPosition,
              map: map,
              icon: { path: google.maps.SymbolPath.CIRCLE, scale: 8, fillColor: "#00FF00", fillOpacity: 1, strokeWeight: 2 }
            });
            map.setCenter(userPosition);
          } else {
            userMarker.setPosition(userPosition);
            if (!routing) {
              map.setCenter(userPosition);
            }
          }
        });
      } else {
        alert("Geolocation not supported");
      }

      const input = document.getElementById("destination");
      const searchBox = new google.maps.places.SearchBox(input);
      const resultsDiv = document.getElementById("searchResults");

      input.addEventListener("input", () => {
        resultsDiv.innerHTML = "";
        resultsDiv.style.display = "none";
      });

      searchBox.addListener("places_changed", () => {
        const places = searchBox.getPlaces();
        if (!places || places.length === 0) return;

        resultsDiv.innerHTML = "";
        places.forEach(place => {
          if (!place.geometry) return;
          const resultDiv = document.createElement("div");
          resultDiv.className = "search-result";

          const span = document.createElement("span");
          span.textContent = place.name;

          const btn = document.createElement("button");
          btn.textContent = "Go";
          btn.onclick = () => {
            document.getElementById("searchResults").style.display = "none";
            input.value = place.name;
            routeTo(place.geometry.location);
          };

          resultDiv.appendChild(span);
          resultDiv.appendChild(btn);
          resultsDiv.appendChild(resultDiv);
        });

        resultsDiv.style.display = "block";
      });

      document.addEventListener("click", (e) => {
        if (!document.getElementById("destination-input").contains(e.target)) {
          resultsDiv.style.display = "none";
        }
      });

      document.getElementById("stopButton").onclick = stopRouting;
    }

    function routeTo(destination) {
      if (!userPosition) {
        alert("Waiting for location...");
        return;
      }

      routing = true;
      document.getElementById("stopButton").style.display = "block";

      directionsService.route({
        origin: userPosition,
        destination: destination,
        travelMode: "DRIVING"
      }, (result, status) => {
        if (status === "OK") {
          directionsRenderer.setDirections(result);
          const duration = result.routes[0].legs[0].duration.text;
          document.getElementById("etaDisplay").innerText = "ETA: " + duration;
          document.getElementById("etaDisplay").style.display = "block";
        } else {
          alert("Routing failed: " + status);
        }
      });
    }

    function stopRouting() {
      directionsRenderer.set("directions", null);
      document.getElementById("etaDisplay").style.display = "none";
      document.getElementById("stopButton").style.display = "none";
      routing = false;
      if (userPosition) {
        map.setCenter(userPosition);
      }
    }

    function recenterMap() {
      if (userPosition) {
        map.setCenter(userPosition);
      }
    }

    window.onload = initMap;
  </script>
</body>
</html>
